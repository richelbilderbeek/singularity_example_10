BootStrap: library
From: ubuntu:18.10

%runscript

    echo "Download a mycobacterium proteome"   
    esearch -db assembly -query '("Mycobacterium"[Organism] OR mycobacterium[All Fields]) AND (latest[filter] AND "complete genome"[filter] AND all[filter] NOT anomalous[filter])' | elink -target nuccore -name assembly_nuccore_refseq | elink -target protein | efetch -db protein -format fasta > mycobacterium.faa 

    echo "Create a shorter version of the mycobacterium proteome"   
    cat mycobacterium.faa | head -n 10 > mycobacterium_short.faa

    echo "Make a database"
    makeblastdb -in mycobacterium_short.faa -dbtype prot

    echo "Get similar proteome sequences"
    blastp -version
    blastp -query mycobacterium_short.faa -db mycobacterium_short.faa -out short_vs_short.xml -outfmt 5

%post

    apt-get update
    apt-get install --yes ncbi-blast+

%labels

    AUTHOR Richel J.C. Bilderbeek

    NAME singularity_example_4
 
    DESCRIPTION Singularity example 4: Singularity 3.2.1, Ubuntu 18.10 and NCBI tools

    USAGE simply run the container

    URL https://github.com/richelbilderbeek/singularity_example_4

    VERSION 1.0
